<!DOCTYPE html>
  <head>
    <meta charset = 'utf-8'>
    <title>Dyn_Form_Function</title>
  </head>
  <body>
    <form name = 'myform' method = 'get' action = 'http://fe.it-academy.by/TestForm.php'> <!-- имя метод и экшн для формы -->
    </form>

    <script>
    var formAh = [
    {'inputtype':'text','label':'Разработчики:','name':'developers','value':null,'selected':'selected','checked':null,}, // field 0
    {'inputtype':'text','label':'Название сайта:','name':'sitename','value':null,'selected':null,'checked':null,}, // field 1
    {'inputtype':'text','label':'URL сайта:','name':'url','value':null,'selected':null,'checked':null,}, // field 2
    {'inputtype':'text','label':'Дата запуска сайта:','name':'data','value':null,'selected':null,'checked':null,}, // field 3
    {'inputtype':'text','label':'Посетителей в сутки:','name':'visiters','value':null,'selected':null,'checked':null,}, // field 4
    {'inputtype':'text','label':'E-mail для связи:','name':'email','value':null,'selected':null,'checked':null,}, // field 5
    {'inputtype':'select','label':'Рубрика каталога:','name':'rubric','option':['здоровье','домашний уют','бытовая техника'],
      'value':[1,2,3],'selected':[null,null,'selected'],'checked':null,}, // field 6
    {'inputtype':'radio','label':'Размещение:','name':'publication','option':['бесплатное','платное','VIP'],'value':[1,2,3],'selected':null,'checked':null,}, // field 7
    {'inputtype':'checkbox','label':'Разрешить отзывы:','name':'comments','value':null,'selected':null,'checked':'checked',}, // field 8
    {'inputtype':'textarea','label':'Описание сайта:','name':'description','value':null,'selected':null,'checked':null,}, // field 9
    {'inputtype':'submit','label':'Опубликовать','name':'name3','value':'Опубликовать','selected':null,'checked':null,}, // field 10
    ]; // сохраняем массив


    function createFormElements(inputtypeV, labelV, nameV, valueV, selectedV, checkedV){
      // возвращает сконструированный элемент
      // аргументы - результат парсинга строки хэша
      // elem[0] - основной элемент формы
      // elem[1] - необязательный, дополнительный элемент формы, подпись например
      var elem = [];
      if((inputtypeV == 'text') || (inputtypeV == 'password')){
        if(labelV){
          //console.log('text+label');
          var elemLabel = document.createElement('label'); // создаем элемент label, сохраняем в переменную elemLabel
          var elemLabelContent = document.createTextNode(labelV); // создаем текстовый узел с содержимым Label
          elemLabel.appendChild(elemLabelContent); // текстовый элемент помещаем внутрь label
          var elemInput = document.createElement('input'); // создаем элемент input
          elemInput.setAttribute('type',inputtypeV); // задаем атрибуту type значение inputtypeV
          elemInput.setAttribute('name', nameV); // задаем атрибуту name значение nameV
          elemLabel.appendChild(elemInput); // элемент input помещаем внутрь элемента label
          elem[0] = elemLabel; // помещаем готовый элемент в переменную elem
        }
        else{
          //console.log('text only');
          var elemInput = document.createElement('input');
          elemInput.setAttribute('type',inputtypeV); // задаем атрибуту type значение password
          elem[0] = elemInput;
        }
      } // /text

      if(inputtypeV == 'radio'){
          if(labelV){
            var elemSpanTitle = document.createElement('span'); // создаем элемент span, сохраняем в переменную elemSpanTitle
            var elemSpanTitileContent = document.createTextNode(labelV); // создаем текстовый узел с содержимым Label
            elemSpanTitle.appendChild(elemSpanTitileContent); // текстовый элемент помещаем внутрь span
            elem[1] = elemSpanTitle;
          } // работает при labelV = 'mylabel' и при labelV = null

            var elemSpan = document.createElement('span'); // создаем элемент span, сохраняем в переменную elemSpan
            for(i=0; i<valueV.length; i++){
              var elemLabel = document.createElement('label'); // создаем элемент label, сохраняем в переменную elemLabel
              var elemInput = document.createElement('input'); // создаем элемент input, сохраняем в переменную elemInput
              elemInput.setAttribute('type', inputtypeV); // задаем атрибуту type значение radio
              elemInput.setAttribute('name', nameV); // задаем атрибуту name значение public
              elemInput.setAttribute('value', valueV[i]); // задаем атрибуту value значение из массива valueV
              var elemLabelContent = document.createTextNode(optionV[i]); // создаем текстовый узел с содержимым option
              elemLabel.appendChild(elemInput); // элемент input помещаем внутрь тэга label
              elemLabel.appendChild(elemLabelContent); // элемент LabelContent помещаем внутрь тэга label
              elemSpan.appendChild(elemLabel); // добавляем радиокнопку в элемент span
            }

            elem[0] = elemSpan; // помещаем блок радиокнопок в elem[0]

      }  // /radio

      if(inputtypeV == 'checkbox'){
          var elemLabel = document.createElement('label'); // создаем элемент label, сохраняем в переменную elemLabel
          var elemLabelContent = document.createTextNode(labelV); // создаем текстовый узел с содержимым Label
          elemLabel.appendChild(elemLabelContent); // текстовый элемент помещаем внутрь label
          var elemInput = document.createElement('input'); // создаем элемент input
          elemInput.setAttribute('type',inputtypeV); // задаем атрибуту type значение inputtypeV
          elemInput.setAttribute('name', nameV); // задаем атрибуту name значение nameV
          if(checkedV){
            elemInput.setAttribute('checked',checkedV); // если есть задаем атрибут checked
          }
          elemLabel.appendChild(elemInput); // элемент input помещаем внутрь элемента label
          elem[0] = elemLabel; // помещаем готовый элемент в переменную elem

      } // /checkbox

      if(inputtypeV == 'select'){
          if(labelV){
            var elemSpan = document.createElement('span'); // создаем элемент span, сохраняем в переменную elemSpan
            var elemSpanContent = document.createTextNode(labelV); // создаем текстовый узел с содержимым Label
            elemSpan.appendChild(elemSpanContent); // текстовый элемент помещаем внутрь span
            elem[1] = elemSpan;
          } // работает при labelV = 'mylabel' и при labelV = null


          elemSelect = document.createElement('select'); // создаем элемент select, сохраняем в переменную elemSelect
          elemSelect.setAttribute('name', nameV); // значение name нужно указать только для тэга Select
          for(var i=0; i<optionV.length; i++){
            var elemOption = document.createElement('option'); // создаем элемент option, сохраняем в переменную elemOption
            var elemOptionContent = document.createTextNode(optionV[i]); // создаем текстовый узел с содержимым Option
            elemOption.appendChild(elemOptionContent); // помещаем содержимое в option
            elemOption.setAttribute('value', valueV[i]); // добавляем атрибут value

            if(selectedV[i]){
              elemOption.setAttribute('selected', 'selected'); // добавим атрибут selected если есть
            }
          elemSelect.appendChild(elemOption); // добавляем элемент option внутрь select
          }
          elem[0] = elemSelect; // а как добавить span

      } // /select


      if(inputtypeV == 'textarea'){
          var elemTextarea = document.createElement('textarea'); // создаем элемент textarea, сохранякм в переменную elemTextarea
          elemTextarea.setAttribute('name', nameV); // задаем атрибуту name значение nameV
          elem[0] = elemTextarea;
          var elemP = document.createElement('p'); // создаем элемент p, сохраняем в переменную elemP
          var elemPContent = document.createTextNode(labelV); // создаем текстовый узел с содержимым labelV
          elemP.appendChild(elemPContent); // помещаем содержимое в elemP
          elem[1] = elemP; // подпись

      } // /textarea

      if(inputtypeV == 'submit'){
          console.log('submit');
          var elemInput = document.createElement('input'); // создаем элемент input, сохраняем в переменную elemInput
          elemInput.setAttribute('type', inputtypeV); // задаем атрибуту type значение submit
          elemInput.setAttribute('value', valueV); // задаем атрибуту value значение valueV
          elem[0] = elemInput;

      } // /submit

    return elem; // возвращаем сгенерированный элемент формы в массиве elem[0], elem[1]
    }

    function parseCreateFormContent(formH){// создает контент для помещения в форму. Принимает один хэш поля формы
          var inputtypeV = null, labelV = null, nameV = null, valueV = null, selectedV = null, checkedV = null;
          // подготоавлваем переменные для парсинга хэша внутри строки
          for(var key in formH){ // перебираем ключи внутри строки
            switch(key){
              case 'inputtype':
                inputtypeV = formH[key];
                break;

              case 'label':
                labelV = formH[key];
                break;

              case 'name':
                nameV = formH[key];
                break;

              case 'value':
                valueV = formH[key];
                break;

              case 'selected':
                selectedV = formH[key];
                break;

              case 'checked':
                checkedV = formH[key];
                break;

              case 'option':
                optionV = formH[key]; // будет массив
                break;
            } // /switch
          } // /for
          var cFE = createFormElements(inputtypeV, labelV, nameV, valueV, selectedV, checkedV);
        return cFE; // возвращает вызов функции createFormElements
    } // /function createFormContent


    function fillForm(dataFormAh,nameForm){ // заполняет форму подготовленным контентом. Принимает массив хэшей, имя формы
      var formElement = document.forms[nameForm]; // мы находим нужную форму по имени
      for(var i = 0; i < dataFormAh.length; i++){ // перебираем массив хэшей
        var formH = dataFormAh[i]; // берем конкретный хэш
        var elem = parseCreateFormContent(formH) //  элемент строки формы, это массив из elem[0] и elem[1]
        formElement.appendChild(elem[0]); // добавляем дочерний elem[0], если один элемент
        if(elem[1]){
          formElement.insertBefore(elem[1],elem[0]); // добавляем второй элемент если есть
        }
        brElement = document.createElement('br'); // создаем элемент <br>
        formElement.appendChild(brElement);// добавляем дочерний элемент <br> в форму
      }
    }

    fillForm (formAh,'myform'); // вызов функции заполнения формы. На вход функции даем наш массив, имя нашей формы.

    </script>
  </body>
</html>